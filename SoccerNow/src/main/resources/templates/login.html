<!DOCTYPE html>
<html lang="en"
      xmlns:th="https://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
  <title>SoccerNow - Login</title>
</head>
<body class="h-screen flex justify-center items-center text-2xl">
<div class="border-2 border-gray-600 flex flex-col p-10 rounded-2xl">
  <p class="mb-4">Welcome back to SoccerNow!</p>

  <form id="login-form" class="flex flex-col">
    <label for="username">Username:</label>
    <input required
           type="text"
           id="username"
           class="mb-4 border-2 border-gray-400 rounded-xl pl-2 text-sm h-10">

    <label for="password">Password:</label>
    <input required
           type="password"
           id="password"
           class="mb-4 border-2 border-gray-400 rounded-xl pl-2 text-sm h-10">

    <button type="submit" class="border-2 rounded-lg p-2 hover:bg-blue-200 cursor-pointer">Login</button>
  </form>

  <p id="error-message" class="text-red-500 mt-4 hidden">Invalid username or password</p>
</div>

<script>
  document.getElementById("login-form").addEventListener("submit", function(event) {
    event.preventDefault();

    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value;

    fetch("/api/credentials/login", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ username: username, password: password })
    })
    .then(response => {
      if (response.ok) {
        window.location.href = "/home";
      } else {
        throw new Error("Unauthorized");
      }
    })
    .catch(error => {
      const errorMessage = document.getElementById("error-message");
      errorMessage.classList.remove("hidden");
      errorMessage.textContent = "Invalid username or password.";
    });
  });
</script>
</body>
</html>
